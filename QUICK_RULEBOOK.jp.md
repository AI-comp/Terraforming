![Title_Logo](rulebook/titleLogo.jpg)

# クイックルール（ルール概要）

## ゲームの概要

プレイヤーはロボットを操作して、開拓・建造・戦闘を通して小惑星を開発する。
敵プレイヤーに負けないよう小惑星を開発しよう！

## ゲームの目的

土地の開拓や建物の建造によって得られる勝利点を、他のプレイヤーよりも多く獲得する。
勝利点の計算方法は後述する。

## フィールド

![Title_Logo](rulebook/gameField.png)

フィールドは図のように1辺が7個の小さい正六角形からなる正六角形の形をしている。
プレイエリアは全部で127マス存在する。

フィールドは4種類のマスから構成されており、ロボットの移動や建物の建造の可否が変わる。

* __荒野 (Wasteland)__

  初期状態のマス。特定の所有者を持たない。
  ロボットが荒野に移動すると、その荒野は所有者の開拓地に変化する（これを占領と呼ぶ）。

* __開拓地 (Settlement)__

  プレイヤーが占領したマス。
  ゲーム画面ではマスがプレイヤーの色で覆われている。
  ロボットが存在する開拓地に建物を建造できる。
  建造を行うと基地に変化する。
  敵対するプレイヤーの開拓地も占領できる。

* __基地 (Base)__

  プレイヤーが建物を建造した後のマス。
  ゲーム画面ではそのプレイヤーの色の建物が置かれている。
  基地には6種類あり、それぞれ異なる効果を持つ。
  ロボットは敵対するプレイヤーの基地に移動できない。

* __穴 (Hole)__

  フィールドのおよそ1/5を占める障害物。
  ロボットが穴に移動すると、穴に落ちるため、それ以降どこにも移動できなくなる。
  後述する _橋_ をその穴に建造すると、その場所にいるロボットが移動できるようになる。
  ゲーム開始時点では所有者が存在しないが、穴に落ちたプレイヤーはその穴を所有している扱いになる。
  プレイヤーは敵対するプレイヤーの所有する穴に移動することもできる。

各マスにはそのマスを所有するプレイヤーのロボットが存在し、その個数は各マスに
![Title_Logo](rulebook/num015.png)
のように表示される。

## フィールドの初期状態
* ゲーム開始時、プレイヤーの初期位置およびフィールドの穴の配置が決定される。
* プレイヤーの初期位置と穴の位置は、各プレイヤーが点対象になるようにランダムに決定される。
* 初期位置には、ロボットが毎ターン5体生成される_ロボット製造機_が配置される。

![Title_Logo](rulebook/initial.png)

上図は初期配置の一例である。図の白マスが _荒野_ 、黒マスが _穴_ 、青マスが _ロボット製造機_ を表している。

## ターン処理

毎ターン、複数箇所のロボットの移動もしくは1箇所での建造が行える。
例えば、移動した後の建造はエラーとなり実行されない。

## ロボットの移動

毎ターン、各ロボットを1ターンに1マス動かすことができる。

すでにロボットが存在するマスに移動させると、ロボット数が加算される。

敵対するロボットが存在するマスに移動させると、数が多い方のロボットが差し引き分残る。

そのマスは残ったロボットの所有者の開拓地となる。

## 資源

![Material](rulebook/materialField.png)  

資源はすべての開拓地に少なくとも1つ存在し建物の建造に使われる。
資源が存在する条件については上図を例に説明する。

上図では、自分自身の所有するそれぞれの開拓地マスの資源の個数を
![Material](rulebook/mat03.png) の個数で表している。

* 使用可能な資源は自分の所有する開拓地にのみ存在する。すなわち、(1,1),(3,1),(3,2)のような荒野には存在しない。また、自分自身が所有していても(2,1)のような穴や(1,3),(3,3),(4,1)のように建物の存在するマスには資源は存在しない。
* 自分の所有する開拓地の周囲に _掘削機_ が存在すれば、そのマスの資源は1つ増える。(2,3)は右側の(3,3)に存在する掘削機のおかげで資源は2つとなり、(4,2)の周囲には左上の(4,1)と、左下の(3,3)に _掘削機_ が存在するため、(4,2)の資源は3個となる。


## 建物

開拓地と穴には建物を建造することができ、建造が行われたマスは基地になる。

なお、穴には_橋_のみが建造でき、残りの建物は_開拓地_にしか建造できない。

建物の建造には資源とロボットが必要である。

* 資源

  建造を行うマスおよび周囲1マスの自分の開拓地に存在する資源の合計が、建造に必要な資源数以上である必要がある。
  
  前述の資源数の図を用いて説明すると(2,2)の周囲1マスには(1,2)(2,2)に1つずつ、(2,3)に2個の資源が存在するため、(2,2)には資源数が4までの建物を建造することが出来る。
  
  建物を建造しても周囲の資源は消費されないが、建造したマス自身は基地になるので資源は消滅する。

* ロボット

  建造を行うマス自身に存在するロボットが、建造に必要なロボット数以上である必要がある。
  
  資源とは異なり、建造の際にロボットはコストの数だけ、消滅する。

### 建物一覧

ゲームに登場する建物は以下の通りである。
建物の隣の数字はその建物に必要な資源数とロボット数である。

#### ロボット系

* ![Material](rulebook/largerobotmaker0.png) __ロボット製造機 (Initial)__ (建造不可)

  自分のターンの開始時にロボットを5体生成する。

* ![Material](rulebook/robotmaker0.png) __小型ロボット製造機 (Robot Maker)__ 資源 4 / ロボット 50

  自分のターンの開始時に、ロボット1体を生成する。

* ![Material](rulebook/attack0.png) __攻撃塔 (Attack Tower)__ 資源 5 / ロボット 25

![Material](rulebook/tower.png)  

  図の青の位置に攻撃塔を配置すると、図の赤で示される半径2の直線状に自分のターンの開始時に攻撃を行う。
  
  攻撃した各マスに敵ロボットが存在するとき、その数を2減らす。
  
#### 資源系

* ![Material](rulebook/excavator0.png) __掘削機 (Excavator)__ 資源 4 / ロボット 25

  隣接マスの自分の開拓地の資源が1個増える。

#### 移動系

* ![Material](rulebook/bridge0.png) __橋 (Bridge)__ 資源 4 / ロボット 15

  穴に橋を建造すると、ロボットは穴から別のマスへ移動できるようになる。

#### 勝利点系

* ![Material](rulebook/house0.png) __家 (House)__ 資源 4 / ロボット 10

  特に効果を持たない

* ![Material](rulebook/town0.png) __街 (Town)__ 資源 9+ / ロボット 10

  周囲1マスの自分の開拓地を _家_ に変更する。
  
  街を建設する際に自分自身とその周囲1マスに存在するマテリアルの数-9の勝利点を建物と別に獲得する。
  
## ゲームの終了

以下の条件のいずれかを満たしたとき、ゲーム終了となる。

1. いずれかのプレイヤーが100点を獲得する
1. 200ターンが経過する

以下のルールに基づいて勝利点を計算し、最も勝利点の高いプレイヤーを勝者とする。

1. 所有する開拓地 → 1マスにつき1点
1. 所有する基地 → 1マスにつき3点
1. _街_ による建設時の加算点

※穴は所有していても勝利点にならない。

2人以上が同点で1位の場合、手番の遅いプレイヤーを勝者とする。

## AI作成上のルール
### ゲーム本体とAIプログラムの動作プロセス
1. ゲーム本体がゲームを初期化
1. ゲーム本体がゲーム状態をAIプログラム1に入力
1. AIプログラム1はプレイヤー名を出力
1. ゲーム本体がゲーム状態をAIプログラム2に入力
1. AIプログラム2はプレイヤー名を出力
1. ゲーム本体がゲーム状態をAIプログラム3に入力
1. AIプログラム3はプレイヤー名を出力
1. ゲーム本体がゲーム状態をAIプログラム1に入力
1. AIプログラム1は1ターン目のコマンド列を出力
1. ゲーム本体がゲーム状態をAIプログラム2に入力
1. AIプログラム2は1ターン目のコマンド列を出力
1. ゲーム本体がゲーム状態をAIプログラム3に入力
1. AIプログラム3は1ターン目のコマンド列を出力
1. ゲームが終了するまで手順8-13を繰り返す

### 入力仕様
以下の形式でAIに対するフィールドの情報が標準入力を介して与えられる。

    START
    ターン番号 最大ターン番号 プレイヤーのID
    フィールドの幅 タイルの数
    タイル1のx座標 y座標 所有者のID ロボットの数 資源数 地形情報 建物
    タイル2のx座標 y座標 所有者のID ロボットの数 資源数 地形情報 建物
    ...
    タイルnのx座標 y座標 所有者のID ロボットの数 資源数 地形情報 建物
    EOS

タイルの所有者がいない場合は「所有者のID」が-1、タイルが穴である場合は「建物」がholeになる。
地形情報とは、4種類のマス情報(荒野(wasteland)、開拓地(settlement)、基地(base)、穴(hole))のことである。

### プレイヤー名の出力方法
SampleAIというプレイヤー名を出力したい場合は、標準出力へ以下の内容を出力する。
ただし、末尾には改行コードを付与すること。

    SampleAI

### コマンド列の出力方法

座標(2, 3)に位置するロボット2体を左に動かしてターンを終了する場合は、標準出力へ以下の内容を出力する。
ただし、末尾には改行コードを付与すること。

    move 2 3 l 2
    finish

以下のようにfinishを複数回出力した場合は、次のターンのコマンド内容が街を建設するコマンドになる。
なお、複数回のbuildコマンドおよびmoveとbuildコマンドの混合は認められないため、家を建設するコマンドは無視される。

    move 2 3 l 2
    finish
    build 1 2 town
    build 2 3 house
    finish


### ゲーム開始時の制限時間
各プレイヤーは5000msの間にゲームの初期状態を受け取ってプレイヤー名を決定しなければならない。
5000msを超えた場合はプレイヤー名が"nanashi"になり失格となる。
なお、ゲームの初期状態には開始時のマップ情報が含まれているため、名前を決める際に戦略を練っても良い。

### ゲーム開始後の制限時間
各プレイヤーは1ターンにつき1000msの間に全てのコマンドを入力しなければならない。
1000ms以内に入力が終了しなかった(finishコマンドが入力されなかった)場合、1ゲーム以内で合計5000msまでの時間超過が認められる。
超過時間が合計で5000msを超えた場合、以降の入力は全てfinishコマンドのみと見なされ、一切コマンド入力ができなくなる。

