# 詳細ルール

## ストーリー
　小惑星探査採掘ロボット”Asterobots”は効率よく小惑星を採掘するための人工知能をプログラミングコンペティションJavaChallenge2012によって公募したことが話題を呼んだ。これによって実用化されたAsterobotは数多の成果を上げ、小惑星についての研究は急速に進むことになった。  
　中でも一番の成果は小惑星内のMaterialが豊富であることにより、小惑星を人の住める環境にするTerraformingが現実味を帯びてきたことである。その結果、小惑星を観光地にしてほしいという要望が高まった。  
　そこで今度は、小惑星にあるMaterialを使って与えられたレシピを元に建物を配置し、都市を作成するロボットの人工知能をプログラミングコンペティションCEDEC CHALLENGE 2013で公募することを決定した。  
　果たして今度もロボットは期待通りの成果が出せるのだろうか？

## Field / フィールド

正六角形127マスを、一辺を7個とする正六角形の形に敷き詰めて使用する。
フィールドの座標系は中心を原点として以下のように設定されている(図では、簡単のため一辺を3個としてある)。

![Field_Axis](rulebook/field_axis.png)

## 地形

各マスは以下の4状態が存在する。

* __Wasteland / 荒野__

    * 資源が存在する。
    * ゲーム開始時点でフィールドに存在する。
    * 所有者は存在しない。
    * ロボットは存在しない。
    * 周囲のマスに居るすべてのロボットは荒野に移動できる。
    * 荒野に周囲のロボットが1体以上移動を行うと、そのマスはプレイヤーの開拓地に変化する。

* __Settlement / 開拓地__

    * 資源が存在する。
    * ゲーム開始時点では存在しない。
    * ただ一人の所有者が存在する。
    * 所有者のロボットが0体以上存在する。
    * 周囲のマスにいるすべてのロボットは開拓地に移動できる。
    * 移動の際、ロボットの数や所有者は変化する→『移動』を参照
    * 開拓地の所有者はその建物を建設できる条件を満たしている場合に、そのマスに橋以外 の建物を建造できる。
    * プレイヤーが開拓地に建造を行うと、そのマスは基地に変化する。

* __Base / 基地__

    * 資源は存在しない。
    * ゲーム開始時点では存在しない。
    * ただ一人の所有者が存在する。
    * 所有者のロボットが0体以上存在する。
    * 周囲のマスにいる自分のロボットは基地に移動できる。所有者以外のロボットは基地へと移動することができない。
    * 建てた建物によって様々な効果が発生する。
    * 建物の具体的な効果については「建物リスト」に記載。
    * 各プレイヤーはゲーム開始時点で1ヶ所の基地（大規模ロボット工場。詳細は「建物リスト」を参照）を持った状態でスタートする。

* __Hole / 穴__

    * 資源は存在しない。
    * ゲーム開始時点でフィールドに存在する。
    * ゲーム開始時点ではどのプレイヤーも所有していない。
    * 所有者のいない穴に周囲のロボットが1体以上移動を行うと、そのプレイヤーが穴の所有者となる。
    * 所有者のいる穴は、そのプレイヤーのロボットを0体以上持つ。
    * 周囲のロボットは穴に向かって移動することが可能。
    * 穴にあるロボットは移動することができない。
    * 穴に所有者が存在する際に、周囲のロボットがその穴に移動した時の処理は開拓地のものと同じ→『移動』を参照
    * 穴の所有者はその穴が橋を建造する条件を満たしている場合、橋を建造できる。
    * プレイヤーが穴に建造を行うとそのマスは基地に変化する。

|未占領チームによる侵攻|占領チームによる建造|種類                   |
|:--------------------:|:------------------:|:----------------------|
|○                    |×                  |荒野 : Wasteland       |
|○                    |○                  |開拓地 : Settlement|
|×                    |×                  |基地 : Base|
|△                    |△                  |穴 : Hole              |
## 初期配置

ゲーム開始時に、各プレイヤーには1マスの大規模ロボット工場(毎ターンロボットを製造する建物)が与えられる。
大規模ロボット工場及び穴の位置は以下の方法でランダムに決定される。
フィールドの3分の1をランダム生成(穴5個、大規模ロボット工場1箇所をランダムに配置)
生成したものを複製し、60度,120度回転させ、残りの3分の2を生成する

<図>
## 資源

初期状態ですべての荒野に1つずつ存在する。
荒野が所有者を持ち開拓地になる際、資源もそのプレイヤーの所有物となる。
基地になった際、その資源は消滅する。
採掘装置を建造すると、その周囲の採掘装置の所有者のプレイヤーの所有する資源は1個ずつ増加する。

すべての建物は建造の際、建物のコスト分の資源を周囲から供給する必要がある。
建造によって周囲の資源が失われることはない。
建造の際の資源の詳細は「建造」の項目を参照

## Move / 移動

移動では、毎ターンすべてのロボットを1ターンに1マス動かすことができる。
ロボットは荒野、操作するプレイヤーの開拓地または都市、敵対するプレイヤーの開拓地、穴のいずれかに向かって移動させることができる。
荒野に進入した場合、そのマスは占領され自分の開拓地になる。
開拓地の所有者と同じプレイヤーのロボットが開拓地に移動した場合、その開拓地のロボットは移動した数だけ増加する。
開拓地の所有者と異なるプレイヤーのロボットが開拓地に移動した場合、所有者は変化せず、その開拓地のロボットは移動した数だけ減少する。移動してきたロボットの数が元からいたプレイヤーのロボットの数を上回った場合、開拓地の所有者は移動してきたロボットを所有するプレイヤーのものとなり、（移動してきたロボットの数−元からいたロボットの数）になる。
基地にはその所有者以外のロボットを移動させることはできない。
その所有者のロボットが移動した場合、基地のロボットは移動した数だけ増加する。
所有者のいない穴にロボットが移動した場合、その穴の所有者は移動したロボットの所有者となり、その穴のロボットは移動した数だけ増加する。
所有者のいる穴へのロボットの移動は開拓地の場合と同じく、ロボットの数、所有者が変化する。

## Build / 建造

建造では、自分の開拓地(橋のみ、自分が所有者である穴)にロボットを消費することで建物を建てて基地へと変化させ、建てた建物に応じた様々な効果を得ることができる。
建造は1ターンに1ヶ所のみ行うことが出来る。
建造は、自分の開拓地及び自分が所有者である穴に対してのみ実行することができる。
建物をグレードアップさせることはできない。
建造で消費するロボット数は建物によって異なり、建造する際には消費数より多いロボットが建造地となるマスに存在していなければならない。
また、建造することができるのは、建造地となるマス及びそれに隣接したマスのうち、自分の開拓地となっているマスにある資源の個数の合計以下のコストを持つ建物である。
建造を行ったマスは基地へと変化するためそのマスの資源は消失するが、建造によって周囲のマスにある資源が失われることはない。
以下に例として4コスト、9コスト、19コストの資源が存在する例を示す。

## ゲームの流れ

ゲームは以下のターンを各プレイヤーごとに順番に繰り返すことにより行われる。

### 各ターンの流れ

各ターンは以下の4つのフェイズからなり、これらのフェイズがこの順で実行される。

* ターン開始フェイズ
* 入力フェイズ
* 処理フェイズ
* ターン終了フェイズ

各フェイズでは以下の処理がなされる。

#### ターン開始フェイズ

このフェイズでは、自分の基地に建っている建物のうち、ターン開始時効果を持つ建物の効果が自動的に処理される。
(例:シールドの周囲に存在する自分のロボットの数を1/2倍する)
処理が終了すると自動的にコマンド入力フェイズに移る。

#### 入力フェイズ

このフェイズでは、以下の3つの操作を入力することができる。
* 移動:自分のロボットを今いるマスから隣のマスに移動させる
* 建造:自分の開拓地になっているマスに建物を建てる
* 終了:コマンド入力フェイズを終了する
このうち、移動と建造は、1ターンにつきどちらか1つだけを入力することができる。
終了を入力すると処理フェイズに移り、実際に入力した操作について処理が行われる。

#### 処理フェイズ

このフェイズでは、入力フェイズに入力した操作が、入力した順で処理される。
処理が終了すると自動的にターン終了フェイズに移る。

#### ターン終了フェイズ

このフェイズでは、自分の基地に建っている建物のうち、ターン終了時効果を持つ建物の効果が自動的に処理される。
処理が終了するとプレイヤーのターンが終了し、別のプレイヤーのターンが始まる。

### ゲームの終了

以下の条件のいずれかを満たしたとき、ゲーム終了となる。

1. フィールドに存在するマスがすべていずれかのプレイヤーの基地となる
1. 100ターンが経過する

### 得点計算と勝敗
ゲームが終了したとき、以下の条件に基づいて各プレイヤーの得点を計算し、最も得点が高いプレイヤーを勝者とする。

1. 自分の開拓地1マスにつき1点
1. 得点系以外の基地1マスにつき2点
1. 自分の基地に存在する家、街1マスにつき3点
1. 自分の基地に存在する公共施設1マスにつき10点

##用語集

* __穴__

	地形の1つ。
	穴に落ちたロボットは移動することができなくなるが、橋を建造することで移動することができ
るようになる。

* __移動__

	プレイヤーが行う操作の1つ。
	自分のロボットをあるマスから隣接するマスに動かす。

* __開拓地__

	地形の1つ。
	所有者が存在し、プレイヤーによる取り合いが行われるマス。

* __基地__

	地形の1つ。
	建物が存在し、ゲームに様々な影響を及ぼすマス。

* __建造__

	プレイヤーが行う操作の1つ。
	開拓地に建物を建てて基地へと変化させる。

* __荒野__

	地形の1つ。
	マスの初期状態。

* __コスト__

	建物を建造する際に必要となる資源およびロボット。

* __資源__

	小惑星に存在する物質で、建造を行うために必要なもの。

* __所有者__

	ロボット、開拓地、穴を所有しているプレイヤー。

* __占領__

	荒野にロボットを移動させて自分の開拓地に変更する行為。

* __大規模ロボット工場__

	建物の1つ。
	各プレイヤーがゲーム開始時に1つずつ与えられ、毎ターン5台のロボットが出現する。

* __建物__

	基地に建っているオブジェクト。
	建っている種類によって、ゲームに様々な影響を及ぼす。

* __地形__
	フィールドに存在するマスの状態を表す用語。

* __橋__
	
	建物の1つ。
	穴に建造することで自分の基地に変化させ、ロボットの移動を可能にする。

* __フィールド__

	ロボットたちが開発を繰り広げるエリア。
	フィールドは六角形のマスで構成されている。

